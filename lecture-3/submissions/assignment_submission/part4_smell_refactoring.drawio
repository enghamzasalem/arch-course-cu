<mxfile host="Electron" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/29.5.2 Chrome/142.0.7444.265 Electron/39.6.1 Safari/537.36" version="29.5.2" pages="2">
  <diagram name="Smell 1 - God Component Refactoring" id="smell1">
    <mxGraphModel dx="846" dy="788" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1100" pageHeight="600" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="h1" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontStyle=1;fontSize=12;fillColor=#f8cecc;" value="Before (God Component: single component does too much)" vertex="1">
          <mxGeometry height="24" width="420" x="40" y="20" as="geometry" />
        </mxCell>
        <mxCell id="god" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=2;" value="Device &amp; Security &amp;&#xa;Automation Service&#xa;(God Component: too many responsibilities)" vertex="1">
          <mxGeometry height="80" width="280" x="160" y="60" as="geometry" />
        </mxCell>
        <mxCell id="c1" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;" value="Clients" vertex="1">
          <mxGeometry height="50" width="80" x="40" y="75" as="geometry" />
        </mxCell>
        <mxCell id="e1" edge="1" parent="1" source="c1" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#333333;edgeStyle=orthogonalEdgeStyle;" target="god">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="140" y="100" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="h2" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontStyle=1;fontSize=12;fillColor=#d5e8d4;" value="After (split into bounded microservices)" vertex="1">
          <mxGeometry height="24" width="320" x="520" y="20" as="geometry" />
        </mxCell>
        <mxCell id="c2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;" value="Clients" vertex="1">
          <mxGeometry height="40" width="70" x="520" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s1" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;" value="Device&#xa;Manager" vertex="1">
          <mxGeometry height="50" width="100" x="680" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;" value="Security&#xa;&amp; Alerts" vertex="1">
          <mxGeometry height="50" width="100" x="680" y="120" as="geometry" />
        </mxCell>
        <mxCell id="s3" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;" value="Automation&#xa;&amp; Scheduler" vertex="1">
          <mxGeometry height="50" width="100" x="680" y="190" as="geometry" />
        </mxCell>
        <mxCell id="bus" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;fillColor=#e1d5e7;" value="Event Bus" vertex="1">
          <mxGeometry height="50" width="120" x="840" y="150" as="geometry" />
        </mxCell>
        <mxCell id="e2" edge="1" parent="1" source="c2" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#333333;edgeStyle=orthogonalEdgeStyle;" target="s1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="635" y="80" />
              <mxPoint x="635" y="75" />
              <mxPoint x="680" y="75" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e3" edge="1" parent="1" source="c2" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#333333;edgeStyle=orthogonalEdgeStyle;" target="s2">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="635" y="80" />
              <mxPoint x="635" y="145" />
              <mxPoint x="680" y="145" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e4" edge="1" parent="1" source="c2" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#333333;edgeStyle=orthogonalEdgeStyle;" target="s3">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="635" y="80" />
              <mxPoint x="635" y="215" />
              <mxPoint x="680" y="215" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e5" edge="1" parent="1" source="s1" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#9673a6;edgeStyle=orthogonalEdgeStyle;" target="bus">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="730" y="110" />
              <mxPoint x="900" y="110" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e6" edge="1" parent="1" source="bus" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#9673a6;edgeStyle=orthogonalEdgeStyle;" target="s2">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="810" y="160" />
              <mxPoint x="810" y="160" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e7" edge="1" parent="1" source="bus" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#9673a6;edgeStyle=orthogonalEdgeStyle;" target="s3">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="900" y="220" />
            </Array>
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram name="Smell 2 - Circular Dependencies Refactoring" id="smell2">
    <mxGraphModel grid="1" page="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" pageScale="1" pageWidth="1100" pageHeight="600" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="h1" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontStyle=1;fontSize=12;fillColor=#f8cecc;" value="Before (A → B → C → A — circular dependency)" vertex="1">
          <mxGeometry height="24" width="380" x="40" y="20" as="geometry" />
        </mxCell>
        <mxCell id="a" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;" value="Device&#xa;Manager&#xa;(A)" vertex="1">
          <mxGeometry height="50" width="90" x="135" y="60" as="geometry" />
        </mxCell>
        <mxCell id="b" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;" value="Security&#xa;Service&#xa;(B)" vertex="1">
          <mxGeometry height="50" width="90" x="40" y="200" as="geometry" />
        </mxCell>
        <mxCell id="c" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;" value="Automation&#xa;Service&#xa;(C)" vertex="1">
          <mxGeometry height="50" width="90" x="230" y="200" as="geometry" />
        </mxCell>
        <mxCell id="cy1" edge="1" parent="1" source="a" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#b85450;edgeStyle=orthogonalEdgeStyle;" target="b">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="180" y="130" />
              <mxPoint x="85" y="130" />
              <mxPoint x="85" y="200" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="cy2" edge="1" parent="1" source="b" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#b85450;edgeStyle=orthogonalEdgeStyle;" target="c">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="130" y="225" />
              <mxPoint x="230" y="225" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="cy3" edge="1" parent="1" source="c" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#b85450;edgeStyle=orthogonalEdgeStyle;" target="a">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="275" y="225" />
              <mxPoint x="180" y="225" />
              <mxPoint x="180" y="110" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="h2" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontStyle=1;fontSize=12;fillColor=#d5e8d4;" value="After (break cycle via Event Bus — no direct runtime dependency cycle)" vertex="1">
          <mxGeometry height="24" width="400" x="520" y="20" as="geometry" />
        </mxCell>
        <mxCell id="a2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;" value="Device&#xa;Manager" vertex="1">
          <mxGeometry height="50" width="90" x="520" y="80" as="geometry" />
        </mxCell>
        <mxCell id="b2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;" value="Security&#xa;Service" vertex="1">
          <mxGeometry height="50" width="90" x="640" y="80" as="geometry" />
        </mxCell>
        <mxCell id="c2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;" value="Automation&#xa;Service" vertex="1">
          <mxGeometry height="50" width="90" x="760" y="80" as="geometry" />
        </mxCell>
        <mxCell id="bus2" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;fillColor=#e1d5e7;" value="Message&#xa;Broker" vertex="1">
          <mxGeometry height="55" width="120" x="640" y="200" as="geometry" />
        </mxCell>
        <mxCell id="r1" edge="1" parent="1" source="a2" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#82b366;edgeStyle=orthogonalEdgeStyle;" target="bus2">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="610" y="165" />
              <mxPoint x="640" y="165" />
              <mxPoint x="640" y="200" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="r2" edge="1" parent="1" source="bus2" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#82b366;edgeStyle=orthogonalEdgeStyle;" target="b2">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="660" y="200" />
              <mxPoint x="660" y="165" />
              <mxPoint x="685" y="165" />
              <mxPoint x="685" y="130" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="r3" edge="1" parent="1" source="bus2" style="endArrow=classic;endFill=1;html=1;strokeWidth=2;strokeColor=#82b366;edgeStyle=orthogonalEdgeStyle;" target="c2">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="740" y="200" />
              <mxPoint x="740" y="165" />
              <mxPoint x="805" y="165" />
              <mxPoint x="805" y="130" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="note" parent="1" style="text;html=1;strokeColor=none;fillColor=#f5f5f5;align=center;fontSize=10;" value="Events flow one way: producers → broker → consumers. No cycle." vertex="1">
          <mxGeometry height="28" width="360" x="520" y="300" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
