<mxfile host="65bd71144e">
    <diagram id="Microservices_Pattern" name="Part 3: Microservices Pattern">
        <mxGraphModel dx="1026" dy="782" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="600" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                
                <!-- Title & Annotations -->
                <mxCell id="title" value="&lt;b&gt;Architectural Pattern: Microservices (with Event-Driven Hybrid)&lt;/b&gt;&lt;br&gt;System: Smart Home Management System" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=14;" vertex="1" parent="1">
                    <mxGeometry x="20" y="20" width="450" height="40" as="geometry"/>
                </mxCell>
                
                <mxCell id="annotation1" value="&lt;b&gt;Pattern Element: API Gateway&lt;/b&gt;&lt;br&gt;Acts as the single entry point, routing requests to the correct independent service." style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffffcc;strokeColor=#d6b656;align=left;fontSize=11;spacingLeft=5;" vertex="1" parent="1">
                    <mxGeometry x="600" y="50" width="220" height="60" as="geometry"/>
                </mxCell>

                <mxCell id="annotation2" value="&lt;b&gt;Pattern Element: Independent Services&lt;/b&gt;&lt;br&gt;Each service owns its own data and logic, deployable and scalable independently." style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffffcc;strokeColor=#d6b656;align=left;fontSize=11;spacingLeft=5;" vertex="1" parent="1">
                    <mxGeometry x="600" y="220" width="220" height="60" as="geometry"/>
                </mxCell>

                <mxCell id="annotation3" value="&lt;b&gt;Pattern Element: Event Broker (Hybrid)&lt;/b&gt;&lt;br&gt;Allows asynchronous, decoupled communication for IoT telemetry streams." style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffffcc;strokeColor=#d6b656;align=left;fontSize=11;spacingLeft=5;" vertex="1" parent="1">
                    <mxGeometry x="600" y="380" width="220" height="60" as="geometry"/>
                </mxCell>

                <!-- Components -->
                <mxCell id="client" value="Client (App/Web)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
                    <mxGeometry x="40" y="100" width="120" height="40" as="geometry"/>
                </mxCell>

                <mxCell id="gw" value="&lt;b&gt;API Gateway&lt;/b&gt;&lt;br&gt;(Pattern Component)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
                    <mxGeometry x="240" y="90" width="140" height="60" as="geometry"/>
                </mxCell>

                <!-- Microservices group -->
                <mxCell id="box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#82b366;dashed=1;" vertex="1" parent="1">
                    <mxGeometry x="210" y="190" width="350" height="150" as="geometry"/>
                </mxCell>
                <mxCell id="box_lbl" value="&lt;b&gt;Independent Microservices&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="210" y="170" width="200" height="20" as="geometry"/>
                </mxCell>

                <mxCell id="ms1" value="Device Manager&#10;(Service A)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
                    <mxGeometry x="240" y="210" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="db1" value="DB A" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=10;fillColor=#f8cecc;strokeColor=#b85450;align=center;" vertex="1" parent="1">
                    <mxGeometry x="275" y="275" width="50" height="50" as="geometry"/>
                </mxCell>

                <mxCell id="ms2" value="Security Service&#10;(Service B)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
                    <mxGeometry x="410" y="210" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="db2" value="DB B" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=10;fillColor=#f8cecc;strokeColor=#b85450;align=center;" vertex="1" parent="1">
                    <mxGeometry x="445" y="275" width="50" height="50" as="geometry"/>
                </mxCell>

                <mxCell id="broker" value="&lt;b&gt;Event Bus / Broker&lt;/b&gt;&lt;br&gt;(Pattern Connector)" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
                    <mxGeometry x="290" y="400" width="190" height="60" as="geometry"/>
                </mxCell>

                <!-- Annotator lines -->
                <mxCell id="a_line1" style="endArrow=none;dashed=1;html=1;strokeColor=#333333;" edge="1" parent="1" source="gw" target="annotation1"><mxGeometry relative="1" as="geometry"/></mxCell>
                <mxCell id="a_line2" style="endArrow=none;dashed=1;html=1;strokeColor=#333333;" edge="1" parent="1" source="box" target="annotation2"><mxGeometry relative="1" as="geometry"/></mxCell>
                <mxCell id="a_line3" style="endArrow=none;dashed=1;html=1;strokeColor=#333333;" edge="1" parent="1" source="broker" target="annotation3"><mxGeometry relative="1" as="geometry"/></mxCell>

                <!-- Connections -->
                <mxCell id="e1" value="HTTP (Pattern Conn.)" style="endArrow=classic;html=1;" edge="1" parent="1" source="client" target="gw"><mxGeometry relative="1" as="geometry"/></mxCell>
                <mxCell id="e2" value="gRPC" style="endArrow=classic;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="gw" target="ms1"><mxGeometry relative="1" as="geometry"/></mxCell>
                <mxCell id="e3" value="gRPC" style="endArrow=classic;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="gw" target="ms2"><mxGeometry relative="1" as="geometry"/></mxCell>
                <mxCell id="e4" style="endArrow=classic;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="ms1" target="db1"><mxGeometry relative="1" as="geometry"/></mxCell>
                <mxCell id="e5" style="endArrow=classic;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="ms2" target="db2"><mxGeometry relative="1" as="geometry"/></mxCell>
                <mxCell id="e6" value="Publish Async" style="endArrow=classic;html=1;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ms1" target="broker"><mxGeometry relative="1" as="geometry"/></mxCell>
                <mxCell id="e7" value="Subscribe" style="endArrow=classic;html=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="broker" target="ms2"><mxGeometry relative="1" as="geometry"/></mxCell>

            </root>
        </mxGraphModel>
    </diagram>
</mxfile>
